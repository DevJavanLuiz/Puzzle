<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css">

</head>

<body onKeyDown="checaControles(event.keyCode)">

    <p id="titulo">
        <span id=numero_8> 8 </span>
        <span id=letra_P> P </span>
        <span id=letra_U> U </span>
        <span id=letra_Z1> Z </span>

        <span id=letra_Z2> Z </span>
        <span id=letra_L> L </span>
        <span id=letra_E> E </span>
    </p>

    <div>
        <!-- Tabela com 3 colunas, uma vazia apenas para ajudar na centralização, uma com o tabuleiro e uma última incluindo os botões de dificuldade, o botão nova partida e o número de movimentos -->
        <table id=tabela_central>
            <tr> <!-- coluna vazia -->
                <td class="coluna_vazia"></td>
                <!-- coluna com uma nova tabela com o tabuleiro -->
                <td>
                    <h2 id=principal></h2>
                    <form name="frmJogo">
                        <table class="tabuleiro">
                            <tr>
                                <td id=celula_1> 8 </td>
                                <td id=celula_2> 4 </td>
                                <td id=celula_3> 1 </td>
                            </tr>
                            <tr>
                                <td id=celula_4>7 </td>
                                <td id=celula_5> </td>
                                <td id=celula_6> 2 </td>
                            </tr>
                            <tr>
                                <td id=celula_7> 3 </td>
                                <td id=celula_8> 5 </td>
                                <td id=celula_9> 6 </td>
                            </tr>
                        </table>
                    </form>
                </td>

                <!-- coluna com a dificuldade, o botão nova partida e o número de movimentos -->
                <td>
                    <p id=resultado> Dificuldade: </p>
                    <form name="frmSetup" id=frmSetup>
                        <input type="radio" name="dificuldade" value="D" CHECKED> Difícil <br><br>
                        <input type="radio" name="dificuldade" value="N"> Normal <br><br>
                        <input type="radio" name="dificuldade" value="C"> Bebê de colo
                    </form>
                    <input type="button" id=btnNovoJogo value="Novo jogo" onclick="nova_partida()">
                    <h1 id=jogadas_realizadas> movimentos: 0 </h1>
                    </form>
                </td>
            </tr>
        </table>
    </div>

    <script>
        var solucao = 0;
        var matriz_cores = [];
        var cores = [];
        var tabuleiro = [];
        var movimento = 0;
        var x_branco = 0;
        var y_branco = 0;
        var dificuldade = 100;

        window.onload = function () {
            nova_partida();

        }

        function nova_partida() {
            inicializa_variaveis();
            preenche_tabuleiro();
            solucao = verifica_se_ganhou();
            imprime_vitoria(solucao);
            // embaralha_tabuleiro();
        }

        function inicializa_variaveis() {
            document.getElementById("resultado").innerHTML = "<strong>Dificuldade";
            if (frmSetup.dificuldade.value == "D") {
                dificuldade = 100;
            } else if (frmSetup.dificuldade.value == "N") {
                dificuldade = 50;
            } else {
                dificuldade = 5;
            }
            matriz_cores[0] = ["#FF8000", "#CC0000", "#660066"];
            matriz_cores[1] = ["#009900", "#000000", "#FF66FF"];
            matriz_cores[2] = ["#66FF66", "#0000CC", "#A8A8A8"];

            cores = ["#FF8000", "#CC0000", "#660066", "#009900", "#000000", "#FF66FF", "#66FF66", "#0000CC", "#A8A8A8"];
            tabuleiro[0] = [1, 2, 3];
            tabuleiro[1] = [4, 5, 6];
            tabuleiro[2] = [7, 8, 9];
            // guarda a posição inicial do branco (valor 9)
            x_branco = 2;
            y_branco = 2;

            document.getElementById("jogadas_realizadas").innerHTML = "movimentos: " + movimento;

        }
        function preenche_tabuleiro() {
            cont = 0;
            for (i = 0; i < tabuleiro.length; i++) {
                for (j = 0; j < tabuleiro[i].length; j++) {
                    cont = cont + 1;
                    if (tabuleiro[i][j] != 9) {
                        celulaTabela = document.getElementById('celula_' + (cont));
                        matriz_cores[i][j] = cores[tabuleiro[i][j] - 1];
                        document.getElementById('celula_' + (cont)).style.background = "" + matriz_cores[i][j];
                        celulaTabela.innerHTML = "" + tabuleiro[i][j];
                    }

                    else {
                        celulaTabela = document.getElementById('celula_' + (cont));
                        celulaTabela.innerText = "";
                        matriz_cores[i][j] = cores[tabuleiro[i][j] - 1];
                        document.getElementById('celula_' + (cont)).style.background = "" + matriz_cores[i][j];
                    }
                }
            }

        }

        function verifica_se_ganhou() {
            k = 0;
            for (i = 0; i < tabuleiro.length; i++) {
                for (j = 0; j < tabuleiro[i].length; j++) {
                    k = k + 1;
                    if (tabuleiro[i][j] != k) // não venceu, solucao = 0;
                        return 0;
                }
            }
            return 1;
        }


        function imprime_vitoria(solucao) {
            if (solucao == 1)
                document.getElementById("resultado").innerHTML = "<strong>Parabéns!!! ";
            else
                document.getElementById("resultado").innerHTML = "<strong>Dificuldade";

        }
        function checaControles(tecla) {
            if (tecla == 37) {
                console.log("teclou para esquerda ");
            }
            if (tecla == 38) {
                console.log("teclou para cima");
            }
            if (tecla == 39) {
                console.log( "mova o 8");
            }
            if (tecla == 40) {
                console.log( "mova o 6");
            }
        }

       function checaTabuleiro (){
        if(tabuleiro !== 'number') return alert('ERROR')
        if(tabuleiro >= 8) return alert('ERROR')
       }

    </script>
</body>

</html>